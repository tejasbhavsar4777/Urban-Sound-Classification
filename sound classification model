#Creating Keras Model and Testing
#Model for sound classification:
#CNN 2D with 64 units and tanh activation.
#MaxPool2D with 2*2 window.
#CNN 2D with 128 units and tanh activation.
#MaxPool2D with 2*2 window.
#Dropout Layer with 0.2 drop probability.
#DL with 1024 units and tanh activation.
#DL 10 units with softmax activation.
#Adam optimizer with categorical_crossentropy loss function.
#90 epochs have been used.

model.add(conv2D(64,(3,3), padding="same", activation="tanh", input_shape = input_dim))
model.add(MaxPool2D(pool_size=(2, 2)))
model.add(Conv2D(128, (3, 3), padding = "same", activation = "tanh"))
model.add(MaxPool2D(pool_size=(2, 2)))
model.add(Dropout(0.1))
model.add(Flatten())
model.add(Dense(1024, activation = "tanh"))
model.add(Dense(10, activation = "softmax"))


model.compile(optimizer, "adam", loss='categorical_crossentropy', metrics = ['accuracy'])

model.fit(x_train, y_train, epochs=90, batch_size, 50,validation_data = (X_test, Y_test))

model.summary()
predictions = model.predict(x_test)
score = model.evaluate(x_test,y_test)
print(score)

preds = np.argma(predictions, axis = 1)

result = pd.dataFrame(preds)

result.to_csv("urbansound8k.csv")....


